package main

import (
        "encoding/json"
        "os"
)

type Config struct {
        Port     string json:"port"
        Host     string json:"host"
        Debug    bool   json:"debug"
        Database string json:"database"
}

type ConfigProvider interface {
        Load() (Config, error)
}

type FileConfigProvider struct {
        FilePath string
}

func (f FileConfigProvider) Load() (Config, error) {
        data, err := os.ReadFile(f.FilePath)
        if err != nil {
                return Config{}, err
        }
        var cfg Config
        if err := json.Unmarshal(data, &cfg); err != nil {
                return Config{}, err
        }
        return cfg, nil
}

type EnvConfigProvider struct{}

func (e EnvConfigProvider) Load() (Config, error) {
        return Config{
                Port:     os.Getenv("PORT"),
                Host:     os.Getenv("HOST"),
                Debug:    os.Getenv("DEBUG") == "true",
                Database: os.Getenv("DATABASE"),
        }, nil
}

func main() {
        cfg, err := FileConfigProvider{"config.json"}.Load()
        if err != nil {
                panic(err)
        }
        println("Из файла:", cfg.Host, cfg.Port)

        envCfg, _ := EnvConfigProvider{}.Load()
        println("Из env:", envCfg.Host, envCfg.Port)
}
